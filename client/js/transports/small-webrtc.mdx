---
title: "SmallWebRTCTransport"
description: "A lightweight WebRTC transport for peer-to-peer connections with Pipecat"
---

The `SmallWebRTCTransport` class provides a WebRTC transport layer for connecting to Pipecat's `SmallWebRTCTransport` server-side implementation. It handles audio/video device management, WebRTC connections, and real-time communication between clients and bots.

## Usage

### Basic Setup

```javascript
import { RTVIClient } from "@pipecat-ai/client-js";
import { SmallWebRTCTransport } from "@pipecat-ai/small-webrtc-transport";

const transport = new SmallWebRTCTransport();

const rtviClient = new RTVIClient({
  transport,
  enableCam: false, // Default camera off
  enableMic: true, // Default microphone on
  callbacks: {
    // Event handlers
  },
  params: {
    baseUrl: "http://localhost:7860",
    endpoints: {
      connect: "/api/offer",
    },
  },
});

await rtviClient.connect();
```

## API Reference

### Constructor

```typescript
new SmallWebRTCTransport();
```

No parameters are required for basic functionality.

### Properties

<ResponseField name="iceServers" type="string[]">
  Array of STUN/TURN server URLs for ICE connection establishment. Default is `["stun:stun.l.google.com:19302"]`.

```javascript
// Set custom ICE servers
transport.iceServers = [
  "stun:stun.l.google.com:19302",
  "stun:stun1.l.google.com:19302",
];
```

</ResponseField>

### Methods

Most methods have an equivalent in the RTVI client. The transport is designed to be used with the RTVI client, so in most cases you should use the RTVI client methods to interact with the transport, rather than calling these methods directly. This is especially true for `initialize()`, `connect()`, and `disconnect()`.

<ResponseField name="setAudioCodec" type="method">
  Sets the preferred audio codec.

```javascript
transport.setAudioCodec("opus");
```

</ResponseField>

<ResponseField name="setVideoCodec" type="method">
  Sets the preferred video codec.

```javascript
transport.setVideoCodec("VP8");
```

</ResponseField>

### States

The transport can be in one of these states:

```typescript
type TransportState =
  | "initializing"
  | "initialized"
  | "connecting"
  | "connected"
  | "ready"
  | "disconnecting"
  | "disconnected"
  | "error";
```

## Events

The transport implements the various [RTVI event handlers](https://docs.pipecat.ai/client/js/api-reference/callbacks). These events will fire when used with an RTVIClient.

Key callback events:

<ResponseField name="onConnected" type="callback">
  Called when connection to the server is established and the data channel is
  ready.
</ResponseField>

<ResponseField name="onDisconnected" type="callback">
  Called when connection to the server is lost.
</ResponseField>

<ResponseField name="onTransportStateChanged" type="callback">
  Called when the transport state changes.
</ResponseField>

<ResponseField name="onTrackStarted" type="callback">
  Called when a new track is received from the server.
</ResponseField>

## Connection Process

The connection process follows these steps:

1. The client creates a new RTCPeerConnection
2. Audio and video transceivers are added
3. A data channel is created for messaging
4. An offer is created and sent to the server endpoint
5. The server responds with an SDP answer
6. The connection is established when ICE candidates are exchanged

## Reconnection Handling

The transport includes automatic reconnection logic:

- Up to 3 reconnection attempts after connection failures
- Detection of ICE connection state changes
- Graceful recovery from temporary disconnections

## More Information

<CardGroup cols={2}>
  <Card
    horizontal
    title="Video Transform Demo"
    icon="video"
    href="https://github.com/pipecat-ai/pipecat/tree/main/examples/p2p-webrtc/video-transform"
  >
    Real-time video transformation example
  </Card>
  <Card
    horizontal
    title="Package"
    icon="browser"
    href="https://www.npmjs.com/package/@pipecat-ai/small-webrtc-transport"
  >
    `@pipecat-ai/small-webrtc-transport`
  </Card>
</CardGroup>
